<!-- Mermaid support for journal mindmaps -->
<script type="module">
  import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs";

  function convertMermaidCodeBlocks() {
    const blocks = document.querySelectorAll('pre > code.language-mermaid');
    blocks.forEach((code) => {
      const pre = code.parentElement;
      const div = document.createElement('div');
      div.className = 'mermaid';
      div.textContent = code.textContent;
      pre.replaceWith(div);
    });
  }

  window.addEventListener('DOMContentLoaded', async () => {
    try {
      convertMermaidCodeBlocks();
      mermaid.initialize({ startOnLoad: false });
      await mermaid.run({ querySelector: '.mermaid' });
    } catch (e) {
      console.warn('Mermaid render failed', e);
    }
  });
</script>
